<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
    <channel>
        <title>Tunnel on 寻道之旅博客</title>
        <link>https://hublog.netlify.app/tags/tunnel/</link>
        <description>Recent content in Tunnel on 寻道之旅博客</description>
        <generator>Hugo -- gohugo.io</generator>
        <language>zh-cn</language>
        <copyright>寻道之旅博客</copyright>
        <lastBuildDate>Wed, 25 Jun 2025 07:21:21 +0800</lastBuildDate><atom:link href="https://hublog.netlify.app/tags/tunnel/index.xml" rel="self" type="application/rss+xml" /><item>
        <title>Cloudflare Tunnel内网穿透服务指南</title>
        <link>https://hublog.netlify.app/p/250625072121/</link>
        <pubDate>Wed, 25 Jun 2025 07:21:21 +0800</pubDate>
        
        <guid>https://hublog.netlify.app/p/250625072121/</guid>
        <description>&lt;h2 id=&#34;前言&#34;&gt;前言
&lt;/h2&gt;&lt;p&gt;本来吧，买了个阿里云服务器部署服务，前几天阿里云告诉我域名注册商必须转回国内，因为各种原因最后决定取消备案。&lt;/p&gt;
&lt;p&gt;结果就是空有公网服务器，用域名反向代理后因为没有备案访问不了。&lt;/p&gt;
&lt;p&gt;最后算了，在这台服务器上部署内网穿透吧。&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;在阿里云上部署内网穿透，这叫啥事啊。。。
这个服务器还有 1 年多几个月，打算先用几个月，最后把那一年给退了。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id=&#34;简介&#34;&gt;简介
&lt;/h2&gt;&lt;p&gt;本文将介绍使用 Cloudflare Tunnel 服务实现内网穿透，做到因为各种原因其他人无法在公网访问你本地服务的人实现访问。&lt;/p&gt;
&lt;h2 id=&#34;正文&#34;&gt;正文
&lt;/h2&gt;&lt;h3 id=&#34;准备&#34;&gt;准备
&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;一个域名&lt;/li&gt;
&lt;li&gt;一个 Cloudflare 账号&lt;/li&gt;
&lt;li&gt;docker compose&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;首先准备这三样&lt;/p&gt;
&lt;h3 id=&#34;创建-cloudflare-tunnel&#34;&gt;创建 Cloudflare Tunnel
&lt;/h3&gt;&lt;p&gt;登录 &lt;a class=&#34;link&#34; href=&#34;https://dash.cloudflare.com&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;cloudflare控制面板&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;找到 &lt;code&gt;Zero Trust&lt;/code&gt;，点击进入&lt;/p&gt;
&lt;p&gt;点击 &lt;code&gt;Networks&lt;/code&gt;下的&lt;code&gt;Tunnels&lt;/code&gt;，进入tunnel主界面&lt;/p&gt;
&lt;p&gt;点击 &lt;code&gt;Create a tunnel&lt;/code&gt; 创建一个tunnel服务&lt;/p&gt;
&lt;p&gt;选择 &lt;code&gt;Cloudflared&lt;/code&gt;，接着输入本次的tuennel名字标识，点击下一步&lt;/p&gt;
&lt;p&gt;找到并复制类似这样的一行&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;cloudflared.exe service install eyJhIjoiMzFmMDc3NWM2ZDIxxxxxxxxxxxxxxxxxxxxxxxxx
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;其中 &lt;code&gt; eyJhIjoiMzF&lt;/code&gt;开头的部分就是你本次创建的 cloudflare tunnel服务的访问密钥，记下来，稍后会用到&lt;/p&gt;
&lt;h3 id=&#34;运行-cloudflared&#34;&gt;运行 cloudflared
&lt;/h3&gt;&lt;p&gt;cloudflare tunnel 是穿透服务，运行这个服务的程序是 cloudflared，这个穿透服务可以在各种环境上使用，包括：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Windows&lt;/li&gt;
&lt;li&gt;Mac&lt;/li&gt;
&lt;li&gt;Linux&lt;/li&gt;
&lt;li&gt;Docker&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;为了简单使用和迁移，本次采用 Docker 方式。&lt;/p&gt;
&lt;p&gt;docker compose&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;7
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-yaml&#34; data-lang=&#34;yaml&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nt&#34;&gt;services&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;cloudflared&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;image&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;cloudflare/cloudflared&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;container_name&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;cloudflared &lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;restart&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;unless-stopped&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;network_mode&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;host&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;command&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;tunnel --no-autoupdate run --protocol http2 --token      &lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;c&#34;&gt;#这里填入自己的token即可&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;运行即可成功开启了 cloudflare tunnel。&lt;/p&gt;
&lt;h3 id=&#34;创建公网域名&#34;&gt;创建公网域名
&lt;/h3&gt;&lt;p&gt;回到Cloudflare tunnel，接着进入到 &lt;code&gt;Route tunnel&lt;/code&gt; 找到 &lt;code&gt;Public hostname&lt;/code&gt;部分：&lt;/p&gt;
&lt;p&gt;Hostname&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Subdomain：子域名&lt;/li&gt;
&lt;li&gt;Domain：主域名&lt;/li&gt;
&lt;li&gt;Path：路径，选填&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Service&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Type：类型，包含了 &lt;code&gt;http&lt;/code&gt;、&lt;code&gt;https&lt;/code&gt;、&lt;code&gt;unix&lt;/code&gt;、&lt;code&gt;tcp&lt;/code&gt;、&lt;code&gt;ssh&lt;/code&gt;&amp;hellip;一系列协议&lt;/li&gt;
&lt;li&gt;URL：本地服务的&lt;code&gt;ip:port&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;设置好，保存即可&lt;/p&gt;
&lt;p&gt;参考：&lt;/p&gt;
&lt;p&gt;&lt;a class=&#34;link&#34; href=&#34;https://club.fnnas.com/forum.php?mod=viewthread&amp;amp;tid=24863&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;(无需公网ip,无需端口号）使用Docker Compose部署Cloudflare Tunnel实现内网穿透&lt;/a&gt;&lt;/p&gt;
</description>
        </item>
        
    </channel>
</rss>
